{{ define "main" }}
<!-- Main Content Area -->
<main class="max-w-7xl mx-auto py-12 sm:py-20 container-padding">

    <!-- 1. Hero Section (No Change) -->
    <section id="about" class="pb-16 text-center sm:text-left">
        <p class="text-xl sm:text-2xl font-light text-accent mb-2">Hello, I'm MickTheLinuxGeek -- A Hobbyist Engineer.</p>
        <h2 class="text-5xl sm:text-7xl font-extrabold leading-tight mb-6">
		<span class="text-white block">Building</span>
		<span class="text-white block">Automating</span>
		<span class="text-primary block"> Self-Hosting</span>
        </h2>
        <p class="text-lg sm:text-xl max-w-4xl mx-auto sm:mx-0 text-gray-400">
            I explore the intersection of code and infrastructure, driven by a passion for **open source**, efficient **automation**, and mastering the Linux ecosystem within my own dedicated **home lab**.
        </p>
        <div class="mt-8">
            <a href="#focus" class="inline-block px-8 py-3 bg-primary text-white font-semibold rounded-lg shadow-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-[1.01]">
                See My Focus Areas &rarr;
            </a>
        </div>
    </section>

    <!-- 2. Core Focus Areas Section (No Change) -->
    <section id="focus" class="pt-12 pb-16 border-t border-gray-800">
        <h3 class="text-3xl sm:text-4xl font-bold mb-4 text-white">My Core Focus</h3>
        <div class="section-separator"></div>
        <div class="grid md:grid-cols-3 gap-8">
            <!-- Card 1: Open Source -->
            <div class="bg-gray-800 p-6 rounded-xl shadow-2xl transition duration-300 hover:shadow-primary/50 hover:bg-gray-700">
                <span class="icon text-primary mb-4 block">&#128187;</span>
                <h4 class="text-xl font-semibold mb-3 text-white">Open Source Contribution</h4>
                <p class="text-gray-400">
                    I believe in the power of shared knowledge. I'm active in using, testing, and occasionally contributing bug fixes or documentation to projects I rely on, particularly in the infrastructure space.
                </p>
            </div>
            <!-- Card 2: Automation & Scripting -->
            <div class="bg-gray-800 p-6 rounded-xl shadow-2xl transition duration-300 hover:shadow-accent/50 hover:bg-gray-700">
                <span class="icon text-accent mb-4 block">&#128640;</span>
                <h4 class="text-xl font-semibold mb-3 text-white">Automation & DevOps</h4>
                <p class="text-gray-400">
                    My goal is to eliminate repetitive tasks. I use Python, Bash, and tools like Ansible and Terraform to define, deploy, and manage my entire environment as code, from bare metal to application.
                </p>
            </div>
            <!-- Card 3: Home Lab & Infrastructure -->
            <div class="bg-gray-800 p-6 rounded-xl shadow-2xl transition duration-300 hover:shadow-indigo-500/50 hover:bg-gray-700">
                <span class="icon text-indigo-400 mb-4 block">&#127968;</span>
                <h4 class="text-xl font-semibold mb-3 text-white">Linux Home Lab</h4>
                <p class="text-gray-400">
                    My personal infrastructure is built on Linux. I run virtual machines, containers (Docker/K8s), and self-hosted services for learning, resilience, and personal data ownership.
                </p>
            </div>
        </div>
    </section>
    
    <!-- 3. Projects Showcase (THIS SECTION IS NOW DYNAMIC) -->
    <section id="projects" class="pt-12 pb-16 border-t border-gray-800">
        <h3 class="text-3xl sm:text-4xl font-bold mb-4 text-white">Current Projects</h3>
        <div class="section-separator"></div>
        <p class="text-xl text-gray-400 mb-8">
            Here are a few applications and infrastructure projects I'm actively building and running in my lab.
        </p>
        
        <div class="grid md:grid-cols-2 gap-8">
            
            <!-- Get the 2 most recent pages from the 'projects' section. Assumes projects are in /content/projects/ -->
            {{ $projectPages := where .Site.RegularPages "Section" "projects" }}
            <!-- Sort by date descending and get the first 2 -->
            {{ $recentProjects := first 2 (sort $projectPages "Date" "desc") }}

            {{ range $i, $project := $recentProjects }}
            <!-- Use modBool to alternate colors based on index ($i) -->
            {{ $isOdd := (modBool $i 2) }}
            {{ $borderColor := "border-primary" }}
            {{ $titleColor := "text-primary" }}
            {{ $linkColor := "text-accent" }}
            
            {{ if $isOdd }}
                {{ $borderColor = "border-accent" }}
                {{ $titleColor = "text-accent" }}
                {{ $linkColor = "text-primary" }}
            {{ end }}

            <div class="bg-gray-800 p-6 rounded-xl shadow-xl border-l-4 {{ $borderColor }} hover:bg-gray-700 transition duration-300">
                <h4 class="text-2xl font-semibold mb-2 {{ $titleColor }}">
                    {{ .Title }}
                </h4>
                
                <!-- Get tech from front matter (e.g., tech = ["Linux", "Python"]) -->
                {{ with .Params.tech }}
                <p class="text-sm text-gray-400 mb-4">
                    {{ delimit . ", " }}
                </p>
                {{ end }}
                
                <!-- Use summary from content (plainify to remove any HTML) -->
                <p class="text-gray-300 mb-4">
                    {{ .Summary | plainify }}
                </p>
                
                <!-- Get repo link from front matter (e.g., repo_url = "...") -->
                {{ with .Params.repo_url }}
                <a href="{{ . }}" class="{{ $linkColor }} hover:underline font-medium flex items-center">
                    <!-- e.g., repo_text = "View on GitHub" -->
                    <!-- FIX: Use $project.Params.repo_text and append the arrow -->
                    {{ $project.Params.repo_text | default "View Project" }} &rarr;
                </a>
                {{ end }}
            </div>
            {{ else }}
            <!-- Show this if no posts are found in /content/projects/ -->
            <p class="text-gray-400 md:col-span-2 text-center">No projects found yet. Check back soon!</p>
            {{ end }}
        </div>
    </section>
    
    <!-- 3.5. Blog Posts Section (No Change) -->
    <section id="blog" class="pt-12 pb-16 border-t border-gray-800">
        <h3 class="text-3xl sm:text-4xl font-bold mb-4 text-white">Latest Lab Notes & Blog</h3>
        <div class="section-separator"></div>
        <p class="text-xl text-gray-400 mb-8">
            Musings, deep dives, and documentation from my infrastructure experiments and software builds.
        </p>

        <!-- Get the 3 most recent pages from the 'blog' section. Assumes posts are in /content/blog/ -->
        {{ $blogPages := where .Site.RegularPages "Section" "blog" }}
        <!-- Sort by date descending and get the first 3 -->
        {{ $recentPosts := first 3 (sort $blogPages "Date" "desc") }}

        <div class="grid md:grid-cols-3 gap-8">
            
            {{ range $recentPosts }}
            <a href="{{ .RelPermalink }}" class="block bg-gray-800 p-6 rounded-xl shadow-xl hover:bg-gray-700 transition duration-300 group">
                
                <!-- Use Front Matter (e.g., categories = ["Automation"]) or default to "Blog" -->
                <p class="text-sm font-semibold text-accent mb-2">
                    {{ with .Params.categories }}
                        {{ index . 0 | title }} | 
                    {{ else }}
                        Blog | 
                    {{ end }}
                    {{ .Date.Format "Jan 2, 2006" }} â€¢ {{ .ReadingTime }} min read
                </p>
                
                <h4 class="text-xl font-semibold mb-2 text-white group-hover:text-primary transition duration-300">
                    {{ .Title }}
                </h4>
                
                <!-- Use Hugo's .Summary for the post preview, truncated to ~200 chars (approx 3 sentences) -->
                <p class="text-gray-400 line-clamp-3 mb-3">
                    {{ .Summary | truncate 200 }}
                </p>
                
                <span class="text-primary hover:text-indigo-400 font-medium transition duration-300">
                    Read More &rarr;
                </span>
            </a>
            {{ else }}
            <!-- Show this if no posts are found in /content/blog/ -->
            <p class="text-gray-400 md:col-span-3 text-center">No blog posts found yet. Check back soon!</p>
            {{ end }}

        </div>
        
        <!-- Link to the main blog list page (e.g., /blog/) -->
        <div class="mt-8 text-center">
            <!-- This finds the 'blog' section page (which uses layouts/_default/list.html) -->
            {{ with .Site.GetPage "section" "blog" }}
            <a href="{{ .RelPermalink }}" class="inline-block px-6 py-2 border border-primary text-primary font-semibold rounded-lg hover:bg-primary hover:text-white transition duration-300">
                Read All Posts &rarr;
            </a>
            {{ end }}
        </div>
    </section>

    <!-- 4. Tech Stack / Tooling Section (No Change) -->
    <section id="tech" class="pt-12 pb-16 border-t border-gray-800">
        <h3 class="text-3xl sm:text-4xl font-bold mb-4 text-white">The Toolkit</h3>
        <div class="section-separator"></div>

        <p class="text-xl text-gray-400 mb-8">
            A selection of the technologies and concepts I enjoy working with and self-hosting.
        </p>

        <div class="flex flex-wrap gap-3 sm:gap-4">
            <!-- Tech Badge Components -->
            <span class="px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-full shadow-md">Linux (Fedora KDE Workstation)</span>
            <span class="px-4 py-2 bg-gray-700 text-gray-200 text-sm font-medium rounded-full shadow-md">Docker & Podman</span>
            <span class="px-4 py-2 bg-accent text-gray-900 text-sm font-medium rounded-full shadow-md">Kubernetes / K3s</span>
            <span class="px-4 py-2 bg-gray-700 text-gray-200 text-sm font-medium rounded-full shadow-md">Ansible</span>
            <span class="px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-full shadow-md">Python & Bash Scripting</span>
            <span class="px-4 py-2 bg-gray-700 text-gray-200 text-sm font-medium rounded-full shadow-md">Terraform / IaC</span>
            <span class="px-4 py-2 bg-accent text-gray-900 text-sm font-medium rounded-full shadow-md">Prometheus & Grafana</span>
            <span class="px-4 py-2 bg-gray-700 text-gray-200 text-sm font-medium rounded-full shadow-md">Git / GitHub Actions</span>
            <span class="px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-full shadow-md">Proxmox / VMware</span>
            <span class="px-4 py-2 bg-gray-700 text-gray-200 text-sm font-medium rounded-full shadow-md">Gitea - Self-Hosted</span>
            <span class="px-4 py-2 bg-accent text-gray-900 text-sm font-medium rounded-full shadow-md">Openmediavault</span>
            <span class="px-4 py-2 bg-gray-700 text-gray-200 text-sm font-medium rounded-full shadow-md">Home Assistant</span>
        </div>
    </section>

    <!-- 5. Contact Section (NOW DYNAMIC) -->
    <section id="contact" class="pt-12 pb-16 border-t border-gray-800">
        <h3 class="text-3xl sm:text-4xl font-bold mb-4 text-white text-center">Let's Connect</h3>
        <p class="text-lg text-gray-400 mb-8 max-w-2xl mx-auto text-center">
            Whether you want to discuss a new open-source project, trade automation tips, or or just talk about the latest Linux kernel update, feel free to reach out.
        </p>
        <div class="flex justify-center space-x-8">
            <!-- GitHub -->
            <!-- Pulls from hugo.toml: [params.social] github = "..." -->
            {{ with .Site.Params.social.github }}
            <a href="{{ . }}" class="text-primary hover:text-indigo-400 transition duration-300" aria-label="GitHub Profile">
                <!-- Inline SVG for GitHub Icon -->
                <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.5.499.09.682-.217.682-.483 0-.237-.009-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.026 2.747-1.026.546 1.379.202 2.398.1 2.65.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.577.688.482A10.001 10.001 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
                </svg>
            </a>
            {{ end }}
            
            <!-- Mastodon -->
            <!-- Pulls from hugo.toml: [params.social] mastodon = "..." -->
            {{ with .Site.Params.social.mastodon }}
            <a href="{{ . }}" class="text-primary hover:text-indigo-400 transition duration-300" aria-label="Mastodon Profile">
                <!-- Inline SVG for Mastodon Icon -->
                <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M23.193 7.88c0-5.207-3.411-6.733-3.411-6.733C18.062.357 15.108.025 12.041 0h-.076c-3.068.025-6.02.357-7.74 1.147 0 0-3.411 1.526-3.411 6.732 0 1.192-.023 2.618.015 4.13.124 5.092.934 10.109 5.641 11.355 2.17.574 4.034.695 5.535.612 2.722-.15 4.25-.972 4.25-.972l-.09-1.975s-1.945.613-4.13.539c-2.165-.074-4.449-.233-4.799-2.891a5.499 5.499 0 0 1-.048-.745s2.125.52 4.817.643c1.646.075 3.19-.097 4.758-.283 3.007-.359 5.625-2.212 5.954-3.905.517-2.665.475-6.507.475-6.507zm-4.024 6.709h-2.497V8.469c0-1.29-.543-1.944-1.628-1.944-1.2 0-1.801.776-1.801 2.312v3.349h-2.483v-3.35c0-1.536-.601-2.312-1.802-2.312-1.085 0-1.628.655-1.628 1.944v6.119H4.833V8.284c0-1.289.328-2.313.987-3.07.679-.757 1.568-1.146 2.674-1.146 1.278 0 2.246.491 2.886 1.474L12 6.585l.622-1.043c.64-.983 1.608-1.474 2.886-1.474 1.106 0 1.995.389 2.674 1.146.659.757.987 1.781.987 3.07v6.305z"/>
                </svg>
            </a>
            {{ end }}

            <!-- Bluesky -->
            <!-- Pulls from hugo.toml: [params.social] bluesky = "..." -->
            {{ with .Site.Params.social.bluesky }}
            <a href="{{ . }}" class="text-primary hover:text-indigo-400 transition duration-300" aria-label="Bluesky Profile">
                <!-- Inline SVG for Bluesky Icon -->
                <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"/>
                </svg>
            </a>
            {{ end }}

            <!-- Email -->
            <!-- Pulls from hugo.toml: [params.social] email = "..." -->
            {{ with .Site.Params.social.email }}
            <a href="mailto:{{ . }}" class="text-3xl text-primary hover:text-indigo-400 transition duration-300" aria-label="Email Address">
                &#x2709;&#xfe0f; <!-- Email Icon -->
            </a>
            {{ end }}
        </div>
    </section>

</main>
{{ end }}
